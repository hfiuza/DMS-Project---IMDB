                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=149698.02..149742.78 rows=17904 width=25) (actual time=1609.600..1609.707 rows=1543 loops=1)
   Sort Key: (((count(CASE WHEN ((movie_rating.info)::text = '1.0'::text) THEN 1 ELSE NULL::integer END) + (count(CASE WHEN ((movie_rating.info)::text = '10.0'::text) THEN 1 ELSE NULL::integer END) * 10)) / count(*))) DESC
   Sort Method: quicksort  Memory: 167kB
   ->  Nested Loop  (cost=40041.52..148433.29 rows=17904 width=25) (actual time=1374.831..1608.919 rows=1543 loops=1)
         ->  HashAggregate  (cost=40041.09..40399.17 rows=17904 width=9) (actual time=1374.803..1596.667 rows=1543 loops=1)
               Group Key: movie_rating.movie_id
               Filter: (count(CASE WHEN (((movie_rating.info)::text <> '1.0'::text) AND ((movie_rating.info)::text <> '10.0'::text)) THEN 1 ELSE NULL::integer END) = 0)
               Rows Removed by Filter: 672765
               ->  Hash Join  (cost=2.43..39638.25 rows=17904 width=9) (actual time=0.075..663.584 rows=674308 loops=1)
                     Hash Cond: (movie_rating.info_type_id = info_type.id)
                     ->  Seq Scan on movie_rating  (cost=0.00..31869.84 rows=2023184 width=13) (actual time=0.028..247.965 rows=2023184 loops=1)
                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on info_type  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=1)
                                 Filter: ((info)::text = 'rating'::text)
                                 Rows Removed by Filter: 112
         ->  Index Scan using movie_pkey on movie  (cost=0.43..6.01 rows=1 width=21) (actual time=0.007..0.007 rows=1 loops=1543)
               Index Cond: (id = movie_rating.movie_id)
 Planning time: 0.573 ms
 Execution time: 1611.538 ms
(20 rows)

