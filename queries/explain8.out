                                                            QUERY PLAN                                                            
----------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=326434.80..326534.38 rows=39834 width=34)
   Sort Key: m1.title, m2.title
   ->  Merge Join  (cost=166268.42..323391.14 rows=39834 width=34)
         Merge Cond: (m2.id = movie_link.linked_movie_id)
         Join Filter: (m1.id <> m2.id)
         ->  Index Scan using movie_pkey on movie m2  (cost=0.43..146668.63 rows=3902967 width=21)
         ->  Sort  (cost=166267.99..166367.58 rows=39834 width=25)
               Sort Key: movie_link.linked_movie_id
               ->  Merge Join  (cost=6201.21..163224.34 rows=39834 width=25)
                     Merge Cond: (m1.id = movie_link.movie_id)
                     ->  Index Scan using movie_pkey on movie m1  (cost=0.43..146668.63 rows=3902967 width=21)
                     ->  Sort  (cost=6200.78..6300.36 rows=39834 width=8)
                           Sort Key: movie_link.movie_id
                           ->  HashAggregate  (cost=2360.44..2758.78 rows=39834 width=8)
                                 Group Key: movie_link.movie_id, movie_link.linked_movie_id
                                 ->  Append  (cost=0.00..2161.27 rows=39834 width=8)
                                       ->  Seq Scan on movie_link  (cost=0.00..154.99 rows=9999 width=8)
                                       ->  Hash Join  (cost=279.98..1607.94 rows=29835 width=8)
                                             Hash Cond: (movie_link_2.movie_id = movie_link_1.linked_movie_id)
                                             Join Filter: (movie_link_1.movie_id <> movie_link_2.linked_movie_id)
                                             ->  Seq Scan on movie_link movie_link_2  (cost=0.00..154.99 rows=9999 width=8)
                                             ->  Hash  (cost=154.99..154.99 rows=9999 width=8)
                                                   ->  Seq Scan on movie_link movie_link_1  (cost=0.00..154.99 rows=9999 width=8)
(23 rows)

