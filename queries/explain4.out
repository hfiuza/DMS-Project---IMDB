                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2355179.13..2355181.25 rows=848 width=15)
   Sort Key: person.name
   ->  Hash Join  (cost=2237524.89..2355137.88 rows=848 width=15)
         Hash Cond: (person.id = cast_info_1.person_id)
         ->  Hash Join  (cost=1116898.11..1234240.11 rows=70003 width=23)
               Hash Cond: (person.id = cast_info.person_id)
               ->  Seq Scan on person  (cost=0.00..94984.16 rows=5775416 width=19)
               ->  Hash  (cost=1116023.08..1116023.08 rows=70003 width=4)
                     ->  HashAggregate  (cost=1114623.02..1115323.05 rows=70003 width=4)
                           Group Key: cast_info.person_id
                           ->  Hash Join  (cost=21.30..1114026.80 rows=238486 width=4)
                                 Hash Cond: (cast_info.role_id = role_type.id)
                                 ->  Seq Scan on cast_info  (cost=0.00..910397.92 rows=53659392 width=8)
                                 ->  Hash  (cost=21.25..21.25 rows=4 width=4)
                                       ->  Seq Scan on role_type  (cost=0.00..21.25 rows=4 width=4)
                                             Filter: ((role)::text = 'director'::text)
         ->  Hash  (cost=1119751.74..1119751.74 rows=70003 width=4)
               ->  HashAggregate  (cost=1118351.68..1119051.71 rows=70003 width=4)
                     Group Key: cast_info_1.person_id
                     ->  Hash Join  (cost=23.61..1117010.19 rows=536594 width=4)
                           Hash Cond: (cast_info_1.role_id = role_type_1.id)
                           ->  Seq Scan on cast_info cast_info_1  (cost=0.00..910397.92 rows=53659392 width=8)
                           ->  Hash  (cost=23.50..23.50 rows=9 width=4)
                                 ->  Seq Scan on role_type role_type_1  (cost=0.00..23.50 rows=9 width=4)
                                       Filter: (((role)::text = 'actor'::text) OR ((role)::text = 'actress'::text))
(25 rows)

