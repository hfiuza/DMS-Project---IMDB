                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=149698.02..149742.78 rows=17904 width=25)
   Sort Key: (((count(CASE WHEN ((movie_rating.info)::text = '1.0'::text) THEN 1 ELSE NULL::integer END) + (count(CASE WHEN ((movie_rating.info)::text = '10.0'::text) THEN 1 ELSE NULL::integer END) * 10)) / count(*))) DESC
   ->  Nested Loop  (cost=40041.52..148433.29 rows=17904 width=25)
         ->  HashAggregate  (cost=40041.09..40399.17 rows=17904 width=9)
               Group Key: movie_rating.movie_id
               Filter: (count(CASE WHEN (((movie_rating.info)::text <> '1.0'::text) AND ((movie_rating.info)::text <> '10.0'::text)) THEN 1 ELSE NULL::integer END) = 0)
               ->  Hash Join  (cost=2.43..39638.25 rows=17904 width=9)
                     Hash Cond: (movie_rating.info_type_id = info_type.id)
                     ->  Seq Scan on movie_rating  (cost=0.00..31869.84 rows=2023184 width=13)
                     ->  Hash  (cost=2.41..2.41 rows=1 width=4)
                           ->  Seq Scan on info_type  (cost=0.00..2.41 rows=1 width=4)
                                 Filter: ((info)::text = 'rating'::text)
         ->  Index Scan using movie_pkey on movie  (cost=0.43..6.01 rows=1 width=21)
               Index Cond: (id = movie_rating.movie_id)
(14 rows)

