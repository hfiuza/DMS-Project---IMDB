                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=325188.70..325796.06 rows=242941 width=25)
   Sort Key: (((count(CASE WHEN ((movie_rating.info)::text = '1.0'::text) THEN 1 ELSE NULL::integer END) + (count(CASE WHEN ((movie_rating.info)::text = '10.0'::text) THEN 1 ELSE NULL::integer END) * 10)) / count(*))) DESC
   ->  Merge Join  (cost=113984.47..297643.83 rows=242941 width=25)
         Merge Cond: (movie_rating.movie_id = movie.id)
         ->  GroupAggregate  (cost=113984.04..135751.61 rows=242941 width=9)
               Group Key: movie_rating.movie_id
               Filter: (count(CASE WHEN (((movie_rating.info)::text <> '1.0'::text) AND ((movie_rating.info)::text <> '10.0'::text)) THEN 1 ELSE NULL::integer END) = 0)
               ->  Sort  (cost=113984.04..115674.92 rows=676350 width=9)
                     Sort Key: movie_rating.movie_id
                     ->  Seq Scan on movie_rating  (cost=0.00..36927.80 rows=676350 width=9)
                           Filter: (info_type_id = 101)
         ->  Index Scan using movie_pkey on movie  (cost=0.43..146668.63 rows=3902967 width=21)
(12 rows)

