                                               QUERY PLAN                                                
---------------------------------------------------------------------------------------------------------
 Nested Loop  (cost=1149109.79..1149278.76 rows=20 width=17)
   ->  Limit  (cost=1149109.36..1149109.41 rows=20 width=4)
         ->  Sort  (cost=1149109.36..1149705.57 rows=238486 width=4)
               Sort Key: (count(cast_info.movie_id)) DESC
               ->  GroupAggregate  (cost=1138589.83..1142763.33 rows=238486 width=4)
                     Group Key: cast_info.movie_id
                     ->  Sort  (cost=1138589.83..1139186.04 rows=238486 width=4)
                           Sort Key: cast_info.movie_id
                           ->  Hash Join  (cost=21.30..1114026.80 rows=238486 width=4)
                                 Hash Cond: (cast_info.role_id = role_type.id)
                                 ->  Seq Scan on cast_info  (cost=0.00..910397.92 rows=53659392 width=8)
                                 ->  Hash  (cost=21.25..21.25 rows=4 width=4)
                                       ->  Seq Scan on role_type  (cost=0.00..21.25 rows=4 width=4)
                                             Filter: ((role)::text = 'director'::text)
   ->  Index Scan using movie_pkey on movie  (cost=0.43..8.45 rows=1 width=21)
         Index Cond: (id = cast_info.movie_id)
(16 rows)

