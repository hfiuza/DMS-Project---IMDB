                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2275683.07..2275683.08 rows=3 width=15)
   Sort Key: person.name
   ->  Nested Loop  (cost=2275658.04..2275683.04 rows=3 width=15)
         ->  HashAggregate  (cost=2275657.60..2275657.63 rows=3 width=4)
               Group Key: ci1.person_id
               ->  Hash Join  (cost=1118611.83..2275657.60 rows=3 width=4)
                     Hash Cond: ((ci1.movie_id = ci2.movie_id) AND (ci1.person_id = ci2.person_id))
                     ->  Hash Join  (cost=23.61..1117062.27 rows=536632 width=8)
                           Hash Cond: (ci1.role_id = rt1.id)
                           ->  Seq Scan on cast_info ci1  (cost=0.00..910435.52 rows=53663152 width=12)
                           ->  Hash  (cost=23.50..23.50 rows=9 width=4)
                                 ->  Seq Scan on role_type rt1  (cost=0.00..23.50 rows=9 width=4)
                                       Filter: (((role)::text = 'actor'::text) OR ((role)::text = 'actress'::text))
                     ->  Hash  (cost=1114078.67..1114078.67 rows=238503 width=8)
                           ->  Hash Join  (cost=21.30..1114078.67 rows=238503 width=8)
                                 Hash Cond: (ci2.role_id = rt2.id)
                                 ->  Seq Scan on cast_info ci2  (cost=0.00..910435.52 rows=53663152 width=12)
                                 ->  Hash  (cost=21.25..21.25 rows=4 width=4)
                                       ->  Seq Scan on role_type rt2  (cost=0.00..21.25 rows=4 width=4)
                                             Filter: ((role)::text = 'director'::text)
         ->  Index Scan using person_pkey on person  (cost=0.43..8.45 rows=1 width=19)
               Index Cond: (id = ci1.person_id)
(22 rows)

