                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2275576.39..2275576.40 rows=3 width=15)
   Sort Key: person.name
   ->  Nested Loop  (cost=2275551.36..2275576.37 rows=3 width=15)
         ->  HashAggregate  (cost=2275550.93..2275550.96 rows=3 width=4)
               Group Key: ci1.person_id
               ->  Hash Join  (cost=1118559.70..2275550.92 rows=3 width=4)
                     Hash Cond: ((ci1.movie_id = ci2.movie_id) AND (ci1.person_id = ci2.person_id))
                     ->  Hash Join  (cost=23.61..1117010.19 rows=536594 width=8)
                           Hash Cond: (ci1.role_id = rt1.id)
                           ->  Seq Scan on cast_info ci1  (cost=0.00..910397.92 rows=53659392 width=12)
                           ->  Hash  (cost=23.50..23.50 rows=9 width=4)
                                 ->  Seq Scan on role_type rt1  (cost=0.00..23.50 rows=9 width=4)
                                       Filter: (((role)::text = 'actor'::text) OR ((role)::text = 'actress'::text))
                     ->  Hash  (cost=1114026.80..1114026.80 rows=238486 width=8)
                           ->  Hash Join  (cost=21.30..1114026.80 rows=238486 width=8)
                                 Hash Cond: (ci2.role_id = rt2.id)
                                 ->  Seq Scan on cast_info ci2  (cost=0.00..910397.92 rows=53659392 width=12)
                                 ->  Hash  (cost=21.25..21.25 rows=4 width=4)
                                       ->  Seq Scan on role_type rt2  (cost=0.00..21.25 rows=4 width=4)
                                             Filter: ((role)::text = 'director'::text)
         ->  Index Scan using person_pkey on person  (cost=0.43..8.45 rows=1 width=19)
               Index Cond: (id = ci1.person_id)
(22 rows)

